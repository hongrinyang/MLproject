# 프로젝트 [TheStorm] 소개

1. 프로젝트 주제의 선정 이유, 기본 상황 제시

 해당 프로젝트의 주제를 선정하게 된 이유는, "미국 주식 투자자로서 최악의 상황에 나스닥이 어떻게 움직이느냐"에 대한 호기심 및 그에 대한 구현을 직접 해보고자 하는 호기로움 때문입니다. 최근 4년 간 코로나로 인해 시작된 연준의 양적완화, 그 과정에서 미국 고용시장에 미치는 영향을 최소화시키기 위한 인플레 가능성의 묵살, 그로 인해 21년 말부터 시작된 다중 인플레이션으로 인한 연준의 단기국채 시장 압박 및 역레포(RRP)(미 단기 국채시장을 지탱하는 시장) 시장의 거래액 증발, 그와 함께 발생한 엄청난 미국의 재정적자로 인한 미국 장기 국채금리(10년물)의 상승(2024.12.19 기준 4.57) 및 단기 국채 수요 부진, 그리고 여전히 실재하는 인플레의 심화가능성(이것 때문에 내년 미국 기준금리의 인하정도는 시장 전망치보다 더 적을 것으로 나타남) 등의 물고 물리는 현상들로 인해, 미국 정부와 연준이 자금 조달을 위해 택할 수 있는 옵션(크게 두 가지로 생각합니다, 스테이블 코인의 제도화를 통한 장,단기 국채 수요 촉진/부득이한 장기 국채 발행 확대)이 가장 적은 시기라 생각했기 때문입니다.
 
 그러한 상황 속에서 미국 은행들이 보유한 미 장기국채의 금리 상승으로 인한 미실현 손실(잘 아시겠지만 국채금리가 상승한다는 말은 채권 가격이 떨어진다는 것을 의미합니다)의 액수가 천문학적인 상황에서, 은행이 도산하는 경우에 따른 금융 위기의 가능성 및 그 일련의 과정에서 나스닥이 어떻게 움직일 지에 대한 시뮬레이션을 머신러닝을 통해 구현해보고자 했습니다.
 
 해당 머신러닝 프로젝트의 기본 전제 2가지는, 비록 작년 초 SVB(실리콘밸리 은행)가 파산했을 당시 BTFP(Bank Term Funding Program), 예금 전액보호조치 등의 진화작업을 했음에도 불구하고, 미국 장기국채 10년물의 금리가 어느 기준값 이상에서 놀게 되었을 때, 코로나 시기인 20~21년 당시에 10년물을 다량 매입한, 10년물의 자산비중이 큰 미국 은행들이 파산하는 경우(대다수는 3분의 1 이상의 자산비중을 10년물로 가져갔음에 유의), 그에 따라 미 정부와 연준이 SVB 사태 때와 같은 대응은 불가능한 상황임을 첫번째로 전제합니다. 그리고 부득이하게 미국 장기 국채의 발행량이 증가할 것으로 보여지는 상황이기에, 그렇다는 걸 가정하고 나스닥에서의 자금 이탈이 어느 정도 발생할 수 있다는 것까지 두번째로 전제합니다. 해당 상황에서 미국 실물 경제의 위축(GDP 성장률과 고용률을 바탕으로 상황을 가정할 것입니다)으로 인해, 은행들이 파산할 때 나스닥이 어떻게 움직일 지에 대한 시뮬레이션을 실행합니다.
 
 이 때 파산의 기준을, 미국의 GDP 성장률이 1.5%, 고용 비율이 59.2%로 주어졌을 때, 미국 장기채 금리의 움직임에 따라 위에 서술한 은행들의 미실현 손실(현재 약 2.5조 달러 이상으로 추정)과 총 자본금(현재 약 2.3조 달러로 추정)의 차이가 DIF(예금보험공사) 지급준비액(현재 1331억 달러의 125%인 약 1664억 달러)보다도 큰 경우에 발생하게끔 설정했습니다. 사실 이미 현재 장기채 금리 상승으로 인해 미국 은행들의 대부분이 자본잠식 상태인 건 사실입니다(NBEA 보고서 기준).

2. 구동 원리 및 메커니즘

 우선 구동을 위해서는 꼭 함께 첨부된 DGS10.csv파일을 다운로드받으시길 바랍니다. 그리고 다운로드 받으신 파일의 경로를, 코드에 기입해주시면 됩니다. 
 
 첫번째로 데이터를 로드하고 전처리하는 과정이 수반됩니다. load_and_preprocess_data 함수는 주어진 CSV 파일을 로드하고, 날짜 열(observation_date)을 날짜 형식으로 변환한 후, 이 날짜를 인덱스로 설정합니다. 이후, 결측값을 제거하고, df['year'] = df.index.year, df['month'] = df.index.month를 통해 각 연도(year)와 월(month) 특성을 추가합니다. 이렇게 생성된 데이터는 이후 회귀 모델의 X = df[['year', 'month', 'DGS10']], y = df['DGS10'], 각 특성 변수(X)와 타겟 변수(y)로 나뉩니다.(특성 변수 (X): year, month, DGS10 (10년물 국채 금리), 타겟 변수 (y): DGS10 (국채 금리 예측))

 뒤에도 등장하겠지만, 선형 회귀(Linear regression) 모델에서는 각 특성 변수(year, month, DGS10)에 대해 회귀 계수가 학습됩니다. 이 계수는 모델이 예측값을 계산할 때 각 특성의 영향을 얼마나 고려할지를 나타냅니다. 예를 들어,

회귀 계수의 해석:

year 계수: year 특성이 1년 증가할 때, 금리(DGS10)가 얼마나 증가하거나 감소하는지 나타냅니다.

month 계수: month가 1개월 증가할 때, 금리 변화에 어떤 영향을 미치는지 나타냅니다.

DGS10 계수: 이전 금리 상태가 현재 금리에 얼마나 영향을 주는지를 나타냅니다.

이러한 회귀 계수는 모델을 설명하는 데 중요한 정보를 제공합니다. 예를 들어, year 계수가 0.05로 나타나면, 이는 매년 국채 금리가 0.05만큼 증가한다고 해석할 수 있습니다.

 다음으로 calculate_unrealized_losses 함수를 정의하는데, 해당 함수는 미실현 손실을 계산합니다. 금리가 변동할 때 국채의 가격은 듀레이션(가격 민감도)과 금리 변동에 비례하여 변하게 됩니다. interest_rate: 현재 금리 (단위: %), bond_duration: 채권의 듀레이션 (기본값: 6년), bond_asset_ratio: 채권 자산 비중 (기본값: 35%) ,capital: 전체 자본금 (기본값: 2.3조 달러)를 각각 의미합니다. 이러한 정의 하에, 금리 변화에 따른 10년물 가격의 변동을 바탕으로 미실현 손실을 계산하며, bond_duration에 금리 변화가 곱해져 채권의 가격 변화를 계산, 이를 자산 비중과 결합해 미실현 손실을 도출합니다.

 그 후 정의된 bankruptcy_probability 함수는 미실현 손실이 은행 자본금에 미치는 영향을 계산합니다. 만약 미실현 손실이 자본금에서 지급준비금을 제외한 금액을 초과하면, 파산 확률을 100%로 설정합니다. 그렇지 않으면, 손실 비율에 비례하는 파산 확률을 계산합니다.

 다음으로는 nasdaq_outflow 함수를 정의하는데, 이 함수는 파산 확률에 따라 나스닥에서 자금 이탈 비율을 예측하는 역할을 담당합니다. 파산 확률이 높을수록 나스닥에서 이탈하는 자금이 더 많을 것으로 가정하고, total_outflow로 설정된 비율을 곱해 이탈 자금을 계산합니다. 예시에서는 10%의 이탈 비율을 설정했습니다. 이 때 각 금융 기관 맟 투자자들이 나스닥에 대한 자산비중을 어떻게 가져가느냐에 따라, 이탈 비율을 변화시킬 수 있을 겁니다.

 위와 같이 변수와 함수들을 정의한 후, 위에서 언급한 선형 회귀(Linear regression) 모델 학습을 진행하는데, sklearn 라이브러리의 LinearRegression을 사용하여 모델을 훈련시킵니다. 훈련된 모델을 사용하여 테스트 데이터에 대한 예측을 수행하고, 그 예측 결과는 금리(DGS10)의 값을 예측하는데 사용됩니다. 이는 금리가 어떻게 변화할 지에 참조될 데이터의 학습입니다.

 막상 코드를 구성하고나니 성능을 나타내는 척도도 필요할 것으로 보여, 모델 성능 평가에 관련한 지표들도 정의를 해놓았습니다. 해당 지표들은 예측 결과와 실제 값의 차이를 계산하여 모델의 성능을 평가합니다. 여기서 사용되는 지표는 MAE(Mean Absolute Error), MSE(Mean Squared Error), RMSE(Root Mean Squared Error)로, 모델의 예측 오차를 나타냅니다.

 마지막으로 결과를 시각화하는 과정이 필요하므로, matplotlib를 사용하여 실제 10년물 국채 금리와 예측 금리의 변화를 시간에 따라 플로팅합니다.

 3. 프로젝트를 하며 든 생각 및 소감

 사실 주제는 정했는데, 해보고 많이 후회했습니다. 경제 상황은 얼추 보이는데, 그럼에도 영향을 미치는 변수들이 너무 많았던 관계로 인해, 초기에 목표했었던 "스테이블 코인의 제도화를 통한 장,단기 국채수요 조정"도 감안한 코드를 작성하는 건 불가능했습니다(사실 가정한다고 하면 되긴 했는데, 스테이블 코인에 대해 찾을 수 있는 정보가 생각보다 적어서..). 그런 부분에서 아쉬움이 남았습니다. 그리고 코드 자체도 좀 부족하다고 생각하고, 저 상황 자체도 굉장히 제한적인 상황이기에, 사실 상황이 변화하면 그에 따라 바꾸거나 추가해야할 요소들도 굉장히 많은 코드인 것이 사실입니다. 투자자로서 볼 수 있는 상황 및 범위와, 보고 싶은 범위의 차이가 좀 느껴졌달까요. 개인적으로는 금융공학을 좀 더 공부해 이를 접목시켜보고 싶었습니다만, 시간의 문제도 있었고 BrownianStock같은 옵션을 다룰 만한 주제는 떠오르지 않아 시기가 맞지 않은 듯 합니다. 

 그럼에도 수업 때 배웠던 선형회귀(Linear Regression)을 이용해 얼추 머신러닝의 형태로, 제가 조금이나마 해보고싶던 "10년물 금리에 따른 미국 은행 및 나스닥에의 여파"에 대해 다뤄볼 수 있어서 영광이었고, 이에 필요한 많은 가르침을 주셔서 감사드립니다. 

 
 
